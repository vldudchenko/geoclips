<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoClips Admin Panel</title>
    <link rel="stylesheet" href="/admin/admin.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé• GeoClips Admin Panel</h1>
            <button class="logout-btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
        </div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</button>
            <button class="nav-tab" onclick="switchTab('analytics')">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
            <button class="nav-tab" onclick="switchTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
            <button class="nav-tab" onclick="switchTab('videos')">üé¨ –í–∏–¥–µ–æ</button>
            <button class="nav-tab" onclick="switchTab('tags')">üè∑Ô∏è –¢–µ–≥–∏</button>
            <button class="nav-tab" onclick="switchTab('comments')">üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</button>
            <button class="nav-tab" onclick="switchTab('system')">‚öôÔ∏è –°–∏—Å—Ç–µ–º–∞</button>
            <button class="nav-tab" onclick="switchTab('logs')">üìù –õ–æ–≥–∏</button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –î–∞—à–±–æ—Ä–¥ -->
        <div id="tab-dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="users-count">-</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="videos-count">-</div>
                    <div class="stat-label">–í–∏–¥–µ–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-views">-</div>
                    <div class="stat-label">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-likes">-</div>
                    <div class="stat-label">–õ–∞–π–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="tags-count">-</div>
                    <div class="stat-label">–¢–µ–≥–æ–≤</div>
                </div>
            </div>

            

            <div class="section">
                <h2>üìä –ö—Ä–∞—Ç–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</h2>
                <div id="dashboard-chart">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤...</div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
        <div id="tab-analytics" class="tab-content">
            <div class="section">
                <h2>üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                <button class="btn" onclick="loadAnalytics()">–û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É</button>
                
                <div class="analytics-period">
                    <div class="period-card">
                        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</h3>
                        <p>–ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <span id="analytics-users-7d">-</span></p>
                        <p>–ù–æ–≤—ã—Ö –≤–∏–¥–µ–æ: <span id="analytics-videos-7d">-</span></p>
                    </div>
                    <div class="period-card">
                        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</h3>
                        <p>–ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <span id="analytics-users-30d">-</span></p>
                        <p>–ù–æ–≤—ã—Ö –≤–∏–¥–µ–æ: <span id="analytics-videos-30d">-</span></p>
                    </div>
                </div>

                <div id="daily-chart">
                    <canvas id="dailyStatsChart"></canvas>
                </div>

                <div class="analytics-grid">
                    <div class="analytics-section">
                        <h3>üèÜ –¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≤–∏–¥–µ–æ</h3>
                        <div id="top-users-list"></div>
                    </div>
                    <div class="analytics-section">
                        <h3>üåü –¢–æ–ø –≤–∏–¥–µ–æ –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</h3>
                        <div id="top-videos-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
        <div id="tab-users" class="tab-content">
            <div class="section">
                <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                
                <div class="search-filter-panel">
                    <input type="text" id="users-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." class="search-input">
                    <select id="users-sort" class="filter-select">
                        <option value="created_at">–ü–æ –¥–∞—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</option>
                        <option value="display_name">–ü–æ –∏–º–µ–Ω–∏</option>
                        <option value="yandex_id">–ü–æ Yandex ID</option>
                    </select>
                    <select id="users-order" class="filter-select">
                        <option value="desc">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                        <option value="asc">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                    </select>
                    <button class="btn" onclick="searchUsers()">üîç –ü–æ–∏—Å–∫</button>
                    <button class="btn btn-secondary" onclick="loadUsers()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="export-panel">
                    <button class="btn btn-secondary" onclick="exportData('users', 'csv')">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('users', 'json')">üì• –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                </div>

                <div id="users-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>
                </div>

                <div class="pagination" id="users-pagination"></div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –í–∏–¥–µ–æ -->
        <div id="tab-videos" class="tab-content">
            <div class="section">
                <h2>üé¨ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ</h2>
                
                <div class="search-filter-panel">
                    <input type="text" id="videos-search" placeholder="–ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ..." class="search-input">
                    <input type="number" id="videos-min-views" placeholder="–ú–∏–Ω. –ø—Ä–æ—Å–º–æ—Ç—Ä—ã" class="filter-input">
                    <input type="number" id="videos-min-likes" placeholder="–ú–∏–Ω. –ª–∞–π–∫–∏" class="filter-input">
                    <select id="videos-sort" class="filter-select">
                        <option value="created_at">–ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è</option>
                        <option value="views_count">–ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</option>
                        <option value="likes_count">–ü–æ –ª–∞–π–∫–∞–º</option>
                    </select>
                    <select id="videos-order" class="filter-select">
                        <option value="desc">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                        <option value="asc">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                    </select>
                    <button class="btn" onclick="searchVideos()">üîç –ü–æ–∏—Å–∫</button>
                    <button class="btn btn-secondary" onclick="loadVideos()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="export-panel">
                    <button class="btn btn-secondary" onclick="exportData('videos', 'csv')">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('videos', 'json')">üì• –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                    <button class="btn btn-danger" onclick="bulkDeleteVideos()" id="bulk-delete-videos-btn" disabled>
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                    </button>
                </div>

                <div id="videos-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...</div>
                </div>

                <div class="pagination" id="videos-pagination"></div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –¢–µ–≥–∏ -->
        <div id="tab-tags" class="tab-content">
            <div class="section">
                <h2>üè∑Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏</h2>
                <button class="btn" onclick="loadTags()">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <div class="tag-form">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥</h3>
                    <div class="form-group">
                        <input class="search-input" type="text" id="new-tag-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞..." maxlength="50" onkeypress="if(event.key==='Enter') createTag()">
                        <button class="btn btn-primary" onclick="createTag()">–°–æ–∑–¥–∞—Ç—å —Ç–µ–≥</button>
                    </div>
                    <div class="form-help">
                        <small>üí° –¢–µ–≥ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω</small>
                    </div>                    
                </div>
                <div class="export-panel">
                    <button class="btn btn-secondary" onclick="exportData('tags', 'csv')">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('tags', 'json')">üì• –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                    <button class="btn btn-danger" onclick="bulkDeleteTags()" id="bulk-delete-tags-btn" disabled>
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                    </button>
                    <button class="btn btn-secondary" onclick="selectAllTags()" id="select-all-btn">
                        ‚úÖ –í—ã–±—Ä–∞—Ç—å –≤—Å–µ
                    </button>
                    <button class="btn btn-secondary" onclick="clearTagSelection()" id="clear-selection-btn">
                        üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä
                    </button>
                </div>
                <div id="tags-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–≥–æ–≤...</div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
        <div id="tab-comments" class="tab-content">
            <div class="section">
                <h2>üí¨ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏</h2>
                <button class="btn" onclick="loadComments()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                
                <div class="filters">
                    <div class="form-group">
                        <label>–§–∏–ª—å—Ç—Ä –ø–æ –≤–∏–¥–µ–æ:</label>
                        <select id="comment-video-filter" onchange="loadComments()" class="filter-select">
                            <option value="">–í—Å–µ –≤–∏–¥–µ–æ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                        <select id="comment-sort" onchange="loadComments()" class="filter-select">
                            <option value="created_at:desc">–ù–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ</option>
                            <option value="created_at:asc">–°—Ç–∞—Ä—ã–µ –ø–µ—Ä–≤—ã–µ</option>
                        </select>
                    </div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-inline">
                        –í—Å–µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: <strong id="comments-total">0</strong>
                    </div>
                    <div class="stat-inline">
                        –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞: <strong id="comments-recent">0</strong>
                    </div>
                </div>
                
                <div class="export-panel">
                    <button class="btn btn-secondary" onclick="exportData('comments', 'csv')">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('comments', 'json')">üì• –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                </div>
                
                <div id="comments-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤...</div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –°–∏—Å—Ç–µ–º–∞ -->
        <div id="tab-system" class="tab-content">
            <div class="section">
                <h2>‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                <button class="btn" onclick="loadSystemInfo()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                
                <div id="system-info-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</div>
                </div>
            </div>

            <div class="section">
                <h2>üßπ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h2>
                <div class="maintenance-actions">
                    <button class="btn btn-warning" onclick="cleanupData('unused_tags')">
                        üè∑Ô∏è –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ–≥–∏
                    </button>
                    <button class="btn btn-warning" onclick="cleanupData('old_videos')">
                        üé¨ –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–∏–¥–µ–æ –±–µ–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                    </button>
                    <button class="btn btn-warning" onclick="fixTagCounters()">
                        üîß –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫–∏ —Ç–µ–≥–æ–≤
                    </button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –õ–æ–≥–∏ -->
        <div id="tab-logs" class="tab-content">
            <div class="section">
                <h2>üìù –õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
                <button class="btn" onclick="loadActivityLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                
                <div id="activity-logs-container">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="/admin/admin-unified.js"></script>
</body>
</html>
